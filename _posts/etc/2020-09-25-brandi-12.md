---
title: "[200925] brandi day 12 :: JOIN"
categories: etc
---
## ì˜¤ì „
### INNER JOIN ì—ì„œì˜ ON vs WHERE   
- ```ON```: JOIN ì„ í•˜ê¸° ì „ì— í•„í„°ë§ì„ í•œë‹¤. ë”°ë¼ì„œ ON ì¡°ê±´ìœ¼ë¡œ í•„í„°ë§ì´ ëœ ë ˆì½”ë“œë“¤ ê°„ JOIN ì´ ì´ë£¨ì–´ì§„ë‹¤.
- ```WHERE```: JOIN ì„ í•œ í›„ í•„í„°ë§ì„ í•œë‹¤. JOIN í•œ ê²°ê³¼ì—ì„œ WHERE ì¡°ê±´ì ˆë¡œ í•„í„°ë§ì´ ì´ë¤„ì§„ë‹¤. 

## ì˜¤í›„
ë©”ë‰´ ë¦¬ìŠ¤íŠ¸ë¥¼ ë³´ë‚´ëŠ” API ë„ ì¿¼ë¦¬ë¬¸ì„ í•œ ë²ˆë§Œ ë³´ë‚´ë„ë¡ ìˆ˜ì •í•˜ê³  ì‹¶ì–´ì„œ ìˆ˜ì •ì„ í•˜ê³  ë‚œ ë’¤ ë¿Œë“¯í•¨ì„ ëŠë¼ë©´ì„œ ê²°ê³¼ë¥¼ í™•ì¸í•´ ë³´ë‹ˆ
![img](https://user-images.githubusercontent.com/26542094/94230845-cca9f600-ff3d-11ea-9221-105d14c22b9c.png)
ë ìš© ë­”ê°€ ì´ìƒí–ˆë‹¤.
í™ˆ, ë­í‚¹ ê°™ì€ ë©”ì¸ ì¹´í…Œê³ ë¦¬ì—ëŠ” í•˜ìœ„ ë©”ë‰´ê°€ ì—†ì–´ì„œ JOIN ì‹œ ë§¤ì¹­ë˜ëŠ” ë ˆì½”ë“œê°€ ì—†ì–´ì„œ ì¶œë ¥ì´ ì•ˆë˜ê³  ìˆì—ˆë‹¤. 
ì´ëŸ´ ë•Œ ì‚¬ìš©í•˜ëŠ” ê²ƒì´ OUTER JOIN!  
í•™êµì—ì„œ ë°°ìš¸ ë•ŒëŠ” ì •ë§ ë‹¨ìˆœí•˜ê²Œ ```INNER JOIN``` ì€ ì¼ì¹˜í•˜ëŠ” ê²ƒë§Œ ì¡°ì¸í•˜ëŠ” ê²ƒ..   
```OUTER JOIN``` ì€ ë§¤ì¹­ì´ ì•ˆë˜ëŠ” ë ˆì½”ë“œë„ ëª¨ë‘ ì¶œë ¥í•˜ëŠ” ê²ƒ..  
ì´ë ‡ê²Œë§Œ ë‹¬ë‹¬ ì™¸ìš°ê³  ê·¼ë° ì–¸ì œ ì•„ìš°í„° ì¡°ì¸ì„ ì‚¬ìš©í•˜ê³  ì™œ ì‚¬ìš©í•˜ì§€?? ë¼ëŠ” ì˜ë¬¸ì— ëŒ€í•´ì„œëŠ” í•´ê²°ì„ ëª»í•˜ê³  ì—´ì‹¬íˆ ì† ì½”ë”©ë§Œ í–ˆì—ˆëŠ”ë° ì§ì ‘ ì‚¬ìš©í•´ì•¼ í•  ìƒí™©ì´ ìƒê¸°ê³  í•„ìš”ì„±ì„ ëŠë¼ê³  ë‚˜ë‹ˆ ëª‡ ë…„ì „ ê¶ê¸ˆì¦ì´ ë‹¨ë²ˆì— í•´ê²°ë˜ì–´ì„œ ê¸°ë¶„ì´ ì¢‹ì•˜ë‹¤ ã…

```sql
SELECT 
    m_cat.id AS m_id, 
    m_cat.main_category_name,
    f_cat.id AS f_id,
    f_cat.first_category_name
FROM main_categories AS m_cat 
LEFT OUTER JOIN first_categories AS f_cat ON m_cat.id = f_cat.main_category_id
```
ë¨¼ì € ë©”ì¸ ì¹´í…Œê³ ë¦¬ì™€ ì²« ë²ˆì§¸ ì¹´í…Œê³ ë¦¬ë§Œ ì‚¬ìš©í•´ì„œ ì•„ìš°í„° ì¡°ì¸ ì‹¤í–‰!
![img](https://user-images.githubusercontent.com/26542094/94231409-eac42600-ff3e-11ea-90da-e170e054189e.png)

ì›í•˜ë˜ ëŒ€ë¡œ í•˜ìœ„ ë©”ë‰´ê°€ ì¡´ì¬í•˜ì§€ ì•ŠëŠ” ë©”ì¸ ë©”ë‰´ë„ ì¶œë ¥ì´ ë˜ë©´ì„œ ë§¤ì¹­ë˜ì§€ ì•ŠëŠ” ì»¬ëŸ¼ì—ëŠ” NULL ê°’ì´ ë‚˜ì™”ë‹¤ ğŸ˜†
```sql
SELECT 
    m_cat.id AS m_id, 
    m_cat.main_category_name,
    f_cat.id AS f_id,
    f_cat.first_category_name,
    f_cat.main_category_id,
    s_cat.id AS s_id,
    s_cat.second_category_name,
    s_cat.first_category_id
FROM main_categories AS m_cat 
LEFT OUTER JOIN first_categories AS f_cat ON m_cat.id = f_cat.main_category_id
LEFT OUTER JOIN second_categories AS s_cat ON f_cat.id = s_cat.first_category_id
```
ì´ì œ ì§„ì§œ ì›í•˜ëŠ” ë°ì´í„° ë‘ ë²ˆì§¸ ì¹´í…Œê³ ë¦¬ê¹Œì§€ ì¶œë ¥ì‹œí‚¤ë„ë¡ ìˆ˜ì •í•˜ê³  ì‹¤í–‰!
![img](https://user-images.githubusercontent.com/26542094/94240708-a2146900-ff4e-11ea-8f24-8e8abb3eaaa5.png)

ì›í•˜ë˜ ë‚´ìš©ìœ¼ë¡œ ì¶œë ¥ë˜ì—ˆë‹¤ ã…ã…

ê·¸ë¦¬ê³  ì´ì   ì»¨íŠ¸ë¡¤ëŸ¬ ìˆ˜ì •ì´ í•„ìš”í•œ ì°¨ë¡€ ã…  

ë°”ë€ DAO ê²°ê³¼ë¥¼ ì´ìš©í•´ì„œ ì›ë˜ ì•½ì†í•œ JSON í˜•íƒœë¡œ ë³´ë‚´ì£¼ì–´ì•¼ í•˜ëŠ”ë° ...  
ì´ì „ê³¼ ê°™ì€ ê³„ì¸µ êµ¬ì¡°ë¡œ ë§ì¶”ëŠ”ê²Œ êµ‰ì¥íˆ í˜ë“¤ì—ˆëŠ”ë° í•œ 4 ì‹œê°„ ì •ë„ ê±¸ë¦° ê²ƒ ê°™ë‹¤ ğŸ˜ƒ

ê° ì¹´í…Œê³ ë¦¬ë¥¼ ê³„ì¸µ êµ¬ì¡°ë¡œ ë³´ë‚´ì¤˜ì•¼í•´ì„œ í•œ ë²ˆì˜ for ë¬¸ìœ¼ë¡œëŠ” ë¶ˆê°€ëŠ¥í–ˆë‹¤.
ì¼ë‹¨ ë‚´ê°€ ì²˜ìŒ ìƒê°í•œ ì½”ë“œì˜ ê²°ê³¼ëŠ” ì•„ë˜ì™€ ê°™ì´ ë©”ì¸ê³¼ ì²« ë²ˆì§¸ ì¹´í…Œê³ ë¦¬ë„ ê³„ì† ì¤‘ë³µí•´ì„œ ì¶œë ¥ë˜ëŠ” ë¬¸ì œê°€ ìˆì—ˆë‹¤. 
![img](https://user-images.githubusercontent.com/26542094/94260512-473d3a80-ff6b-11ea-84bd-838947347076.png)

```
# product_controller.py
category = product_service.get_menu(session)

            # ê° ì¹´í…Œê³ ë¦¬ë¥¼ ì €ì¥í•˜ê¸° ìœ„í•œ ë¦¬ìŠ¤íŠ¸
            second_category = []
            first_category = []
            main_category = []

            for i in category:
                if (i.m_id, i.main_category_name) not in main_category:
                    # ë©”ì¸ ì¹´í…Œê³ ë¦¬ ë¦¬ìŠ¤íŠ¸
                    main_category.append((i.m_id, i.main_category_name))
                if (i.f_id, i.first_category_name, i.main_category_id) not in first_category:
                    # ì²« ë²ˆì§¸ ë°ì´í„° ë¦¬ìŠ¤íŠ¸
                    first_category.append((i.f_id, i.first_category_name, i.main_category_id))
                # ì„¸ ë²ˆì§¸ ì¹´í…Œê³ ë¦¬ ë¦¬ìŠ¤íŠ¸
                second_category.append((i.s_id, i.second_category_name, i.first_category_id))

            body = [{
                'id'      : m_menu[0],
                m_menu[1] : [{
                    'id'      : f_menu[0],
                    f_menu[1] : [{
                        'id'   : s_menu[0],
                        'name' : s_menu[1]
                    } for s_menu in second_category if s_menu[2] == f_menu[0]]
                } for f_menu in first_category if f_menu[2] == m_menu[0]]
            } for m_menu in main_category]
```
